(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[439],{8991:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/common/details",function(){return l(7860)}])},7860:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return y}});var a=l(5893);l(4395),l(2067);var s=l(1164),n=l(381),o=l.n(n),r=l(1163),d=l(7294);l(8085);var i=l(1121),c=l(7696),u=l(4173),x=l(1177),m=l(2702),p=l(4105),h=e=>{let{close:t,data:l,relodeData:n,partyList:r}=e,[i,c]=(0,d.useState)({date:"",amount:"",particular:"",party_id:""}),[x,m]=(0,d.useState)(o()(new Date).format("YYYY-MM-DD"));(0,d.useEffect)(()=>{var e;c({...i,party_id:null===(e=r[0])||void 0===e?void 0:e.value,date:x})},[r]);let p=e=>{let{name:t,value:l}=e.target;c(e=>({...e,[t]:l}))},h=async e=>{e.stopPropagation(),e.preventDefault(),document.getElementById("form").reset();try{var l;let e=await s.Z.post("/common/expense",i);n(),t(),u.Am.success(e.data.message),c({date:"",amount:"",particular:"",party_id:null===(l=r[0])||void 0===l?void 0:l.value})}catch(e){console.log("error in expensesPopup")}};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto  fixed inset-0 z-50 outline-none focus:outline-none",children:(0,a.jsx)("div",{className:"w-72 sm:w-96 xl:w-1/3 my-6 mx-auto max-w-2xl relative bg-white rounded-2xl flex flex-col",children:(0,a.jsxs)("div",{className:"bg-white w-full rounded-lg  shadow-lg  max-h-[80vh] overflow-y-auto relative",children:[(0,a.jsxs)("div",{className:" items-center flex justify-between flex-wrap md:flex-nowrap py-2 md:py-0 px-2 font-bold text-center text-lg md:text-2xl  bg-primary sticky top-0 m-3 rounded",children:[(0,a.jsx)("h2",{className:"grow text-lg lg:text-2xl font-bold text-center w-full md:w-auto",children:"Add Expenses"}),(0,a.jsx)("button",{type:"button",className:"flex-none rounded-md md:p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500  focus:outline-none focus:ring-2 focus:ring-inset focus:ring-black",onClick:()=>t(),children:(0,a.jsx)("svg",{color:"black",className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{id:"form",onSubmit:e=>h(e),className:"space-y-4 md:space-y-4 px-4 pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{for:"name",className:"block text-gray-500 text-sm font-bold mb-2",children:"Particular"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"particular",name:"particular",type:"text",className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter particular",defaultValue:null==i?void 0:i.particular,autoComplete:"off",onChange:p})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{for:"party_id",className:"block text-gray-500 text-sm font-bold mb-2",children:"Select Party"}),(0,a.jsx)("div",{children:(0,a.jsx)("select",{id:"party_id",name:"party_id",defaultValue:null==i?void 0:i.party_id,className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",onChange:p,children:null==r?void 0:r.map(e=>(0,a.jsx)("option",{value:null==e?void 0:e.value,children:null==e?void 0:e.label},null==e?void 0:e.value))})})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{for:"amount",className:"block text-gray-500 text-sm font-bold mb-2",children:"Amount"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"amount",name:"amount",type:"number",className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter amount",step:"any",defaultValue:null==l?void 0:l.amount,autoComplete:"off",onKeyDown:e=>["e","E","+"].includes(e.key)&&e.preventDefault(),onChange:p})})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{for:"date",className:"block text-gray-500 text-sm font-bold mb-2",children:"Date"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"date",name:"date",type:"date",className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter date",defaultValue:x,onChange:p})})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("button",{type:"submit",className:"bg-primary text-black font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline w-9/12 shadow-main",children:"Add Expenses"})})]},null==l?void 0:l._id)]})})}),(0,a.jsx)("div",{className:"opacity-70 fixed inset-0 z-40 bg-black"})]})},f=e=>{let{type:t,close:l,data:n,relodeData:r,partyList:i}=e,[c,x]=(0,d.useState)({date:"",amount:"",particular:"",party_id:""}),[m,p]=(0,d.useState)(o()(new Date).format("YYYY-MM-DD"));(0,d.useEffect)(()=>{var e;x({...c,amount:n.amount,particular:n.particular,party_id:null==n?void 0:null===(e=n.party_id)||void 0===e?void 0:e._id,date:n.date})},[n]);let h=e=>{let{name:t,value:l}=e.target;x(e=>({...e,[t]:l}))},f=async e=>{e.stopPropagation(),e.preventDefault(),document.getElementById("form").reset();try{var t;let e=await s.Z.put("/common/expense?id=".concat(null==n?void 0:n._id),c);r(),l(),u.Am.success(e.data.message),x({date:"",amount:"",particular:"",party_id:null===(t=i[0])||void 0===t?void 0:t.value})}catch(e){console.log("error in contractorPopup",e)}};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto  fixed inset-0 z-50 outline-none focus:outline-none",children:(0,a.jsx)("div",{className:"w-72 sm:w-96 xl:w-1/3 my-6 mx-auto max-w-2xl relative bg-white rounded-2xl flex flex-col",children:(0,a.jsxs)("div",{className:"bg-white w-full rounded-lg  shadow-lg  max-h-[80vh] overflow-y-auto relative",children:[(0,a.jsxs)("div",{className:" items-center flex justify-between flex-wrap md:flex-nowrap py-2 md:py-0 px-2 font-bold text-center text-lg md:text-2xl  bg-primary sticky top-0 m-3 rounded",children:[(0,a.jsx)("h2",{className:"grow text-lg lg:text-2xl font-bold text-center w-full md:w-auto",children:"Edit Expenses"}),(0,a.jsx)("button",{type:"button",className:"flex-none rounded-md md:p-2 inline-flex items-center justify-center text-gray-400 hover:text-gray-500  focus:outline-none focus:ring-2 focus:ring-inset focus:ring-black",onClick:()=>l(),children:(0,a.jsx)("svg",{color:"black",className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("form",{id:"form",onSubmit:e=>f(e),className:"space-y-4 md:space-y-4 px-4 pb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{for:"name",className:"block text-gray-500 text-sm font-bold mb-2",children:"Particular"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"particular",name:"particular",type:"text",className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter particular",value:null==c?void 0:c.particular,autoComplete:"off",onChange:h})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{for:"party_id",className:"block text-gray-500 text-sm font-bold mb-2",children:"Select Party"}),(0,a.jsx)("div",{children:(0,a.jsx)("select",{id:"party_id",name:"party_id",value:null==c?void 0:c.party_id,className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",onChange:h,children:null==i?void 0:i.map(e=>(0,a.jsx)("option",{value:null==e?void 0:e.value,children:null==e?void 0:e.label},null==e?void 0:e.value))})})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{for:"amount",className:"block text-gray-500 text-sm font-bold mb-2",children:"Amount"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"amount",name:"amount",type:"number",className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter amount",step:"any",defaultValue:null==n?void 0:n.amount,autoComplete:"off",onKeyDown:e=>["e","E","+"].includes(e.key)&&e.preventDefault(),onChange:h})})]}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("label",{for:"date",className:"block text-gray-500 text-sm font-bold mb-2",children:"Date"}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"date",name:"date",type:"date",className:"shadow appearance-none border rounded w-full py-2 md:py-3 px-3 md:px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",value:c.date?o()(c.date).format("YYYY-MM-DD"):"",onChange:h})})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("button",{type:"submit",className:"bg-primary text-black font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline w-9/12 shadow-main",children:"Update Expenses"})})]},null==n?void 0:n._id)]})})}),(0,a.jsx)("div",{className:"opacity-70 fixed inset-0 z-40 bg-black"})]})},y=()=>{let e=(0,r.useRouter)(),[t,l]=(0,d.useState)(!1),[n,y]=(0,d.useState)(!1),[v,g]=(0,d.useState)([]),[w,b]=(0,d.useState)([]),[j,N]=(0,d.useState)(e.query.project),[k,_]=(0,d.useState)(!1),[D,C]=(0,d.useState)(!1),[E,S]=(0,d.useState)({}),[Y,P]=(0,d.useState)([]),[A,M]=(0,d.useState)([]),[z,Z]=(0,d.useState)([]),[B,L]=(0,d.useState)([]),V=async()=>{try{var e;let t=await s.Z.get("/common/party?type=list"),l=[];null===(e=t.data.party)||void 0===e||e.map(e=>{l.push({label:null==e?void 0:e.name,value:null==e?void 0:e._id})}),P(l),M(l)}catch(e){console.log("error in getAllParty :",e)}},I=async()=>{try{var e;let t=await s.Z.get("/common/particular"),l=[];null===(e=t.data.particular)||void 0===e||e.map(e=>{l.push({label:e,value:e})}),Z(l),L(l)}catch(e){console.log("error in getAllParticular :",e)}},U=async()=>{try{let e=await s.Z.post("/common/filter",{party:A,particular:B});b(e.data.expense)}catch(e){console.log("error in getAllExpenses :",e)}},X=()=>{I(),V(),U()};(0,d.useEffect)(()=>{U()},[A,B]),(0,d.useEffect)(()=>{V(),I()},[]);let T=(e,t)=>{S(e),"delete"==t?_(!0):"edit"==t&&C(!0)},q=async e=>{try{let t=await s.Z.delete("/common/expense?id=".concat(e));u.Am.success(t.data.message),U(),_(!1)}catch(e){console.log("error in deleteContractor.",e)}},F=()=>{try{y(!0);let e=null==w?void 0:w.map(e=>{var t;return[o()(null==e?void 0:e.date).format("DD-MM-YYYY"),null==e?void 0:null===(t=e.party_id)||void 0===t?void 0:t.name,null==e?void 0:e.particular,null==e?void 0:e.amount]}),t=p.P6.aoa_to_sheet([["Date","Party","Particular","Amount"],...e]),l=t["!ref"].split(":").map(e=>e.match(/[A-Z]+/g)[0]).map(t=>{let l=p.P6.decode_col(t);return e.reduce((e,t)=>{let a=t[l]?t[l].toString():"";return Math.max(e,a.length)},0)});t["!cols"]=l.map(e=>({wch:e+5}));let a=p.P6.book_new();p.P6.book_append_sheet(a,t,"common_details"),p.NC(a,"".concat(o()(new Date).format("DD_MM_YYYY"),"_common_details.xlsx")),y(!1)}catch(e){y(!1),console.log("error in downloadXLSX: ",e)}};return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4  md:flex-row justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4  md:flex-row mb-4 w-full",children:[(0,a.jsx)("div",{className:"w-full sm:w-[30%] md:w-[30%] lg:w-[15%]",children:(0,a.jsx)(x.NU,{options:Y,value:A,onChange:M,labelledBy:"party",isCreatable:!0})}),(0,a.jsx)("div",{className:"w-full sm:w-[30%] md:w-[30%] lg:w-[15%]",children:(0,a.jsx)(x.NU,{options:z,value:B,onChange:L,labelledBy:"Particular",isCreatable:!0})})]}),(0,a.jsxs)("div",{className:"flex justify-end flex-col md:flex-row gap-2 mg:gap-4 min-w-fit",children:[(0,a.jsx)("div",{className:"flex mb-2",children:(0,a.jsx)("div",{className:"md:text-center text-xs sm:text-sm",children:(0,a.jsx)("button",{onClick:()=>F(),class:"flex gap-2 sm:gap-2 items-center bg-transparent hover:bg-green-500 text-green-700 font-semibold hover:text-white py-2 px-2 md:px-4 border border-green-500 hover:border-transparent rounded",children:n?(0,a.jsx)("div",{class:"flex justify-center items-center",children:(0,a.jsx)("div",{class:"w-5 h-5 rounded-full border-4 border-gray-400 border-t-green-700 animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Ljp,{size:20})," Download Excel File"]})})})}),(0,a.jsx)("div",{className:"flex-none md:text-center text-sm",children:(0,a.jsxs)("button",{onClick:()=>l(!0),className:"flex gap-1 md:gap-2 items-center bg-primary font-semibold py-2 px-2 md:px-4 border-2 border-black rounded",children:[(0,a.jsx)(i.poH,{size:20})," Add Expenses"]})})]})]}),(0,a.jsx)("div",{className:"uppercase rounded-t flex flex-col sm:flex-row items-center justify-center px-4 md:px-6 py-2 font-semibold text-md md:text-xl border-b border-gray-100 bg-primary",children:(0,a.jsx)("span",{children:"Common Expense"})}),(0,a.jsx)("div",{className:" overflow-x-auto",children:(0,a.jsx)("div",{className:"min-w-full inline-block align-middle",children:(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("table",{className:"min-w-full divide-y-2 divide-gray-200 border-2",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"rounded border-t-2 bg-text-light m-2 divide-x-2 text-xs font-bold uppercase",children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 w-0.5 text-center flex-none sticky left-0 bg-text-light z-0",children:"No"}),(0,a.jsx)("th",{scope:"col",className:"w-1/12 px-6 py-3 text-center",children:"Date"}),(0,a.jsx)("th",{scope:"col",className:"w-3/12 px-6 py-3 text-center",children:"Party"}),(0,a.jsx)("th",{scope:"col",className:"w-4/12 px-6 py-3 text-center",children:"Particular"}),(0,a.jsx)("th",{scope:"col",className:"w-1/12 px-6 py-3 text-center",children:"Amount"}),(0,a.jsx)("th",{scope:"col",className:"w-1/12 px-6 py-3 text-center",children:"Edit"}),(0,a.jsx)("th",{scope:"col",className:"w-1/12 px-6 py-3 text-center",children:"Delete"})]})}),(0,a.jsx)("tbody",{children:w&&(null==w?void 0:w.map((e,t)=>{var l;return(0,a.jsxs)("tr",{className:"rounded border-t-2 font-medium  m-2 divide-x-2 text-sm uppercase",children:[(0,a.jsx)("td",{scope:"col",className:"px-4 py-2 w-0.5 text-center flex-none sticky left-0 bg-white  z-0",children:t+1}),(0,a.jsx)("td",{scope:"col",className:"w-1/12 px-4 py-2 text-center",children:o()(null==e?void 0:e.date).format("DD-MM-YYYY")}),(0,a.jsx)("td",{scope:"col",className:"w-3/12 px-4 py-2 text-left",children:null==e?void 0:null===(l=e.party_id)||void 0===l?void 0:l.name}),(0,a.jsx)("td",{scope:"col",className:"w-4/12 px-4 py-2 break-words text-left",children:null==e?void 0:e.particular}),(0,a.jsx)("td",{scope:"col",className:"w-1/12 px-4 py-2 text-center",children:null==e?void 0:e.amount}),(0,a.jsx)("td",{scope:"col",className:"w-1/12 px-4 py-2 text-center",children:(0,a.jsxs)("button",{onClick:()=>T(e,"edit"),className:"text-blue-600 bg-blue-100 p-1 rounded-sm flex items-center m-auto gap-1 hover:text-blue-500",children:[(0,a.jsx)(c.v0Y,{}),"Edit"]})}),(0,a.jsx)("td",{scope:"col",className:"w-1/12 px-4 py-2 text-center",children:(0,a.jsxs)("button",{onClick:()=>T(e,"delete"),className:"text-red-600 bg-red-100 p-1 rounded-sm flex items-center m-auto gap-1 hover:text-red-500",children:[(0,a.jsx)(c.GnT,{}),"Delete"]})})]},t)}))})]})})})}),(0,a.jsx)("div",{className:t?"":"hidden",children:(0,a.jsx)(h,{close:l,relodeData:X,projectData:null==v?void 0:v.find(e=>(null==e?void 0:e._id)==j),partyList:Y})}),(0,a.jsx)("div",{className:D?"":"hidden",children:(0,a.jsx)(f,{close:C,relodeData:X,data:E,partyList:Y})}),(0,a.jsx)(m.Z,{isShow:k,close:_,task:()=>q(null==E?void 0:E._id),msg:"Are you sure you want to Delete this expense data ?"})]})}},1164:function(e,t,l){"use strict";let a=l(5121).Z.create({baseURL:"/api"});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t?e.headers.Authorization="Bearer ".concat(t):delete e.headers.Authorization,e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>(e.response&&(401===e.response.status||403===e.response.status)&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e))),t.Z=a}},function(e){e.O(0,[817,885,317,957,251,121,85,8,734,888,774,179],function(){return e(e.s=8991)}),_N_E=e.O()}]);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    